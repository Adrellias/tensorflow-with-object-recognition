# Make any security camera smarter for less than $50 using Tensorflow

Background to this story. I bought recently a Xiaomi security camera from GearBest(https://www.gearbest.com/ip-cameras/pp_615275.html?wid=1433363).
On its own this camera is already quite good. It has 1080p resolution and comes with the MiHome app. You can configure the camera using a schedule and when it detects movement it will send you an alert on your mobile. But here lies the problem. The camera sends you quite a few alerts and only a small percentage will be because a person was detected. Many times, just noise(such as train), a fly going past will trigger the camera. This is not necessarily a bad thing, especially the sound feature, as it can be used for a variety of scenarios in the future. But to be useful in terms of security it needs to only trigger alerts for scenarios which are of real concern. Too many false positives and you end up ignoring the app.

Adding to that, the camera doesn't come with real "cloud storage". But it somehow uploads videos via the MiHome app onto the cloud in order to send you the notifications. But you can configure the camera to save all its videos in a NAS storage location.

The goal of this project is to create an application that processed all the videos generated by my Xiaomi security camera and did a visual inspection of each to ensure that only videos where a person is detected would trigger a notification. In this notification I would be able to see a screenshot of what triggered the camera with a bounding box and also the original video for closer inspection.

## Tools for this project

### Tensorflow
First obvious tool used is Tensorflow. Tensorflow is incredibly powerful and comes with pre-built models that are quite capable to detect something as simple as a person. In fact it can do a lot more than that. The code written uses Tensorflow Object Detection API, which is still in ongoing development.
https://github.com/tensorflow/models/tree/master/research/object_detection. As a starting point I used the object detection tutorial python script.


### OpenCV

Second tool used is OpenCV


### Docker

### Slack

# tensorflow-with-object-recognition

1. Build docker container
docker build -t armindocachada/tensorflow-with-object-recognition .

2. Start docker container

Pass the -v to share the folder with the docker container in which the camera's surveillance files will be available. You need read/write access to the folder.

Pass the -p to expose the port to access the jupyter notebook

docker run -i -t -d -p 8888:8888 -v <NAS FOLDER WITH VIDEOS>:/data/videos/incoming armindocachada/tensorflow-with-object-recognition /bin/bash



 docker exec -it <CONTAINER ID> /bin/bash -c "export COLUMNS=tput cols; export LINES=tput lines; exec bash"

